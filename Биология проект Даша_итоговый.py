# ============================================================================
# –ë–õ–û–ö 1: –ò–ú–ü–û–†–¢ –ë–ò–ë–õ–ò–û–¢–ï–ö
# ============================================================================

# –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
import pandas as pd  # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–∫–∞–∫ Excel –≤ Python)
import numpy as np   # –î–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ —Ä–∞–±–æ—Ç—ã —Å –º–∞—Å—Å–∏–≤–∞–º–∏ —á–∏—Å–µ–ª

# –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
import matplotlib.pyplot as plt  # –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –¥–∏–∞–≥—Ä–∞–º–º
import seaborn as sns  # –î–ª—è –±–æ–ª–µ–µ –∫—Ä–∞—Å–∏–≤—ã—Ö –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤

# –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏–∑ scikit-learn
from sklearn.model_selection import train_test_split  # –î–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏
from sklearn.preprocessing import StandardScaler  # –î–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –æ–¥–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É)
from sklearn.impute import SimpleImputer  # –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

# –ê–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
from sklearn.linear_model import LogisticRegression  # –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
from sklearn.neighbors import KNeighborsClassifier  # –ú–µ—Ç–æ–¥ k-–±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π
from sklearn.tree import DecisionTreeClassifier  # –î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π
from sklearn.ensemble import RandomForestClassifier  # –°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å

# –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π
from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score
from sklearn.metrics import confusion_matrix, classification_report, roc_auc_score, roc_curve

# –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
import joblib  # –ò–ª–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pickle

# –ú–∞–≥–∏—á–µ—Å–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è Jupyter Notebook (–µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –≤ –Ω–µ–º)
# %matplotlib inline

print("‚úÖ –í—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!")

# ============================================================================
# –ë–õ–û–ö 2: –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–•
# ============================================================================

# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞—Ç–∞—Å–µ—Ç –æ –¥–∏–∞–±–µ—Ç–µ
# –ò—Å—Ç–æ—á–Ω–∏–∫: https://www.kaggle.com/datasets/uciml/pima-indians-diabetes-database
try:
    # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    df = pd.read_csv('diabetes.csv')
    print("‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ 'diabetes.csv'")
except:
    # –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
    print("‚ö†Ô∏è –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –∑–∞–≥—Ä—É–∂–∞—é –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞...")
    url = 'https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv'
    # –ù–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ –æ–ø–∏—Å–∞–Ω–∏—é –¥–∞—Ç–∞—Å–µ—Ç–∞
    column_names = ['Pregnancies', 'Glucose', 'BloodPressure', 'SkinThickness', 
                    'Insulin', 'BMI', 'DiabetesPedigreeFunction', 'Age', 'Outcome']
    df = pd.read_csv(url, names=column_names)
    print("‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞!")

# ============================================================================
# –ë–õ–û–ö 3: –ü–ï–†–í–û–ù–ê–ß–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –î–ê–ù–ù–´–• (EDA - Exploratory Data Analysis)
# ============================================================================

print("\n" + "="*60)
print("–®–ê–ì 1: –ü–ï–†–í–û–ù–ê–ß–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –î–ê–ù–ù–´–•")
print("="*60)

# 3.1. –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö
print("\nüìä –ü–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ –¥–∞—Ç–∞—Å–µ—Ç–∞:")
print(df.head())

# 3.2. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–∞—Å–µ—Ç–µ
print("\n –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–∞—Å–µ—Ç–µ:")
print(f"–†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞: {df.shape[0]} —Å—Ç—Ä–æ–∫, {df.shape[1]} —Å—Ç–æ–ª–±—Ü–æ–≤")
print("\n–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:")
print(df.dtypes)

# 3.3. –ü—Ä–æ–≤–µ—Ä–∏–º –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
print("\nüîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:")
missing_values = df.isnull().sum()
print(missing_values[missing_values > 0])

# 3.4. –ù–æ –≤ —ç—Ç–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ 0 –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö
# –ü—Ä–æ–≤–µ—Ä–∏–º, —Å–∫–æ–ª—å–∫–æ –Ω—É–ª–µ–π –≤ –∫–∞–∂–¥–æ–º —Å—Ç–æ–ª–±—Ü–µ
print("\n‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏):")
for column in df.columns:
    if column != 'Pregnancies' and column != 'Outcome':  # –ë–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –∏ Outcome –º–æ–≥—É—Ç –±—ã—Ç—å 0
        zero_count = (df[column] == 0).sum()
        if zero_count > 0:
            print(f"{column}: {zero_count} –Ω—É–ª–µ–π ({zero_count/len(df)*100:.1f}%)")

# 3.5. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
print("\nüìà –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö:")
print(df.describe())

# 3.6. –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ (—Å–∫–æ–ª—å–∫–æ –∑–¥–æ—Ä–æ–≤—ã—Ö –∏ –±–æ–ª—å–Ω—ã—Ö)
print("\n‚öñÔ∏è –ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ (Outcome - —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è):")
class_distribution = df['Outcome'].value_counts()
print(class_distribution)
print(f"\n–ü—Ä–æ—Ü–µ–Ω—Ç –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –¥–∏–∞–±–µ—Ç–æ–º: {class_distribution[1]/len(df)*100:.1f}%")
print(f"–ü—Ä–æ—Ü–µ–Ω—Ç –∑–¥–æ—Ä–æ–≤—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤: {class_distribution[0]/len(df)*100:.1f}%")

# ============================================================================
# –ë–õ–û–ö 4: –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–•
# ============================================================================

print("\n" + "="*60)
print("–®–ê–ì 2: –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–•")
print("="*60)

# –°–æ–∑–¥–∞–µ–º —Ñ–∏–≥—É—Ä—É —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
plt.figure(figsize=(15, 10))

# 4.1. –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
print("\nüìä –°—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤...")
for i, column in enumerate(df.columns[:-1], 1):  # –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ –∫—Ä–æ–º–µ Outcome
    plt.subplot(3, 3, i)
    # –†–∞–∑–¥–µ–ª—è–µ–º –ø–æ –∫–ª–∞—Å—Å–∞–º –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏
    df[df['Outcome'] == 0][column].hist(alpha=0.5, label='–ó–¥–æ—Ä–æ–≤—ã', bins=20)
    df[df['Outcome'] == 1][column].hist(alpha=0.5, label='–î–∏–∞–±–µ—Ç', bins=20)
    plt.title(f'–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ {column}')
    plt.legend()
    plt.xlabel(column)
    plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')

plt.tight_layout()
plt.savefig('histograms.png', dpi=300)
print("‚úÖ –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª 'histograms.png'")
plt.show()

# 4.2. –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏)
print("\nüîó –°—Ç—Ä–æ–∏–º –º–∞—Ç—Ä–∏—Ü—É –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π...")
plt.figure(figsize=(10, 8))
correlation_matrix = df.corr()  # –í—ã—á–∏—Å–ª—è–µ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0)
plt.title('–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏')
plt.tight_layout()
plt.savefig('correlation_matrix.png', dpi=300)
print("‚úÖ –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —Ñ–∞–π–ª 'correlation_matrix.png'")
plt.show()

# 4.3. Boxplot –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–æ–≤
print("\nüì¶ –°—Ç—Ä–æ–∏–º boxplot –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤—ã–±—Ä–æ—Å–æ–≤...")
plt.figure(figsize=(15, 8))
df_boxplot = df.drop('Outcome', axis=1)  # –£–±–∏—Ä–∞–µ–º —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫
sns.boxplot(data=df_boxplot)
plt.title('Boxplot –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–æ–≤')
plt.xticks(rotation=45)
plt.tight_layout()
plt.savefig('boxplot.png', dpi=300)
print("‚úÖ Boxplot —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª 'boxplot.png'")
plt.show()

# ============================================================================
# –ë–õ–û–ö 5: –ü–†–ï–î–û–ë–†–ê–ë–û–¢–ö–ê –î–ê–ù–ù–´–•
# ============================================================================

print("\n" + "="*60)
print("–®–ê–ì 3: –ü–†–ï–î–û–ë–†–ê–ë–û–¢–ö–ê –î–ê–ù–ù–´–•")
print("="*60)

# –°–æ–∑–¥–∞–µ–º –∫–æ–ø–∏—é –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
df_processed = df.copy()

# 5.1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ–ø—É—Å–∫–∏)
print("\nüîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–ø—Ä–æ–ø—É—Å–∫–∏)...")

# –°—Ç–æ–ª–±—Ü—ã, –≥–¥–µ 0 —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å 0 –≥–ª—é–∫–æ–∑—ã –≤ –∫—Ä–æ–≤–∏)
zero_not_allowed = ['Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI']

# –ó–∞–º–µ–Ω—è–µ–º –Ω—É–ª–∏ –Ω–∞ NaN (Not a Number) –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
for column in zero_not_allowed:
    df_processed[column] = df_processed[column].replace(0, np.nan)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã
print("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã 0 –Ω–∞ NaN:")
print(df_processed.isnull().sum())

# 5.2. –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –º–µ–¥–∏–∞–Ω–æ–π (–±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º, —á–µ–º —Å—Ä–µ–¥–Ω–µ–µ)
print("\nüîß –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –º–µ–¥–∏–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏...")
imputer = SimpleImputer(strategy='median')  # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤

# –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö
df_processed[zero_not_allowed] = imputer.fit_transform(df_processed[zero_not_allowed])

print("‚úÖ –ü—Ä–æ–ø—É—Å–∫–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!")

# 5.3. –†–∞–∑–¥–µ–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ (X) –∏ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é (y)
print("\nüìä –†–∞–∑–¥–µ–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é...")
X = df_processed.drop('Outcome', axis=1)  # –í—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∫—Ä–æ–º–µ Outcome
y = df_processed['Outcome']  # –¢–æ–ª—å–∫–æ Outcome (—Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)

print(f"–ü—Ä–∏–∑–Ω–∞–∫–∏ (X): {X.shape}")
print(f"–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è (y): {y.shape}")

# 5.4. –†–∞–∑–¥–µ–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏
print("\n‚úÇÔ∏è –†–∞–∑–¥–µ–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–±—É—á–∞—é—â—É—é (80%) –∏ —Ç–µ—Å—Ç–æ–≤—É—é (20%) –≤—ã–±–æ—Ä–∫–∏...")
X_train, X_test, y_train, y_test = train_test_split(
    X, y, 
    test_size=0.2,  # 20% –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    random_state=42,  # –î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    stratify=y  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤ –≤ –æ–±–µ–∏—Ö –≤—ã–±–æ—Ä–∫–∞—Ö
)

print(f"–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞: {X_train.shape[0]} –ø—Ä–∏–º–µ—Ä–æ–≤")
print(f"–¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞: {X_test.shape[0]} –ø—Ä–∏–º–µ—Ä–æ–≤")
print(f"–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ:")
print(y_train.value_counts(normalize=True))
print(f"\n–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:")
print(y_test.value_counts(normalize=True))

# 5.5. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)
print("\nüìè –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏ (–ø—Ä–∏–≤–æ–¥–∏–º –∫ –æ–¥–Ω–æ–º—É –¥–∏–∞–ø–∞–∑–æ–Ω—É)...")
scaler = StandardScaler()  # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

# –û–±—É—á–∞–µ–º scaler —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ "—É—Ç–µ—á–∫–∏" –¥–∞–Ω–Ω—ã—Ö)
X_train_scaled = scaler.fit_transform(X_train)
# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
X_test_scaled = scaler.transform(X_test)

print("‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω—ã!")

# ============================================================================
# –ë–õ–û–ö 6: –û–ë–£–ß–ï–ù–ò–ï –ú–û–î–ï–õ–ï–ô –ú–ê–®–ò–ù–ù–û–ì–û –û–ë–£–ß–ï–ù–ò–Ø
# ============================================================================

print("\n" + "="*60)
print("–®–ê–ì 4: –û–ë–£–ß–ï–ù–ò–ï –ú–û–î–ï–õ–ï–ô –ú–ê–®–ò–ù–ù–û–ì–û –û–ë–£–ß–ï–ù–ò–Ø")
print("="*60)

# –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
models = {
    '–õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è': LogisticRegression(random_state=42, max_iter=1000),
    '–ú–µ—Ç–æ–¥ k-–±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π': KNeighborsClassifier(n_neighbors=5),
    '–î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π': DecisionTreeClassifier(random_state=42, max_depth=5),
    '–°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å': RandomForestClassifier(random_state=42, n_estimators=100)
}

# –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
results = {}

print("\nüß† –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª–∏...")
for model_name, model in models.items():
    print(f"\n–û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å: {model_name}")
    
    # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    model.fit(X_train_scaled, y_train)
    
    # –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    y_pred = model.predict(X_test_scaled)
    
    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞
    accuracy = accuracy_score(y_test, y_pred)
    precision = precision_score(y_test, y_pred)
    recall = recall_score(y_test, y_pred)
    f1 = f1_score(y_test, y_pred)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    results[model_name] = {
        'model': model,
        'accuracy': accuracy,
        'precision': precision,
        'recall': recall,
        'f1': f1,
        'y_pred': y_pred
    }
    
    print(f"  –¢–æ—á–Ω–æ—Å—Ç—å (Accuracy): {accuracy:.3f}")
    print(f"  –¢–æ—á–Ω–æ—Å—Ç—å (Precision): {precision:.3f}")
    print(f"  –ü–æ–ª–Ω–æ—Ç–∞ (Recall): {recall:.3f}")
    print(f"  F1-–º–µ—Ä–∞: {f1:.3f}")

# ============================================================================
# –ë–õ–û–ö 7: –°–†–ê–í–ù–ï–ù–ò–ï –ò –û–¶–ï–ù–ö–ê –ú–û–î–ï–õ–ï–ô
# ============================================================================

print("\n" + "="*60)
print("–®–ê–ì 5: –°–†–ê–í–ù–ï–ù–ò–ï –ò –û–¶–ï–ù–ö–ê –ú–û–î–ï–õ–ï–ô")
print("="*60)

# 7.1. –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
print("\nüìä –°–†–ê–í–ù–ï–ù–ò–ï –ú–û–î–ï–õ–ï–ô:")
results_df = pd.DataFrame({
    '–ú–æ–¥–µ–ª—å': list(results.keys()),
    '–¢–æ—á–Ω–æ—Å—Ç—å (Accuracy)': [results[m]['accuracy'] for m in results],
    '–¢–æ—á–Ω–æ—Å—Ç—å (Precision)': [results[m]['precision'] for m in results],
    '–ü–æ–ª–Ω–æ—Ç–∞ (Recall)': [results[m]['recall'] for m in results],
    'F1-–º–µ—Ä–∞': [results[m]['f1'] for m in results]
})

# –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ F1-–º–µ—Ä–µ (–ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –ø–æ–ª–Ω–æ—Ç—ã)
results_df = results_df.sort_values('F1-–º–µ—Ä–∞', ascending=False)
print(results_df.to_string(index=False))

# 7.2. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
print("\nüìà –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π...")
plt.figure(figsize=(12, 6))

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
models_names = results_df['–ú–æ–¥–µ–ª—å'].values
metrics = ['–¢–æ—á–Ω–æ—Å—Ç—å (Accuracy)', '–¢–æ—á–Ω–æ—Å—Ç—å (Precision)', '–ü–æ–ª–Ω–æ—Ç–∞ (Recall)', 'F1-–º–µ—Ä–∞']

# –°–æ–∑–¥–∞–µ–º –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞
x = np.arange(len(models_names))
width = 0.2  # –®–∏—Ä–∏–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤

# –°—Ç—Ä–æ–∏–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–æ–ª–±—á–∞—Ç—ã–π –≥—Ä–∞—Ñ–∏–∫
for i, metric in enumerate(metrics):
    values = results_df[metric].values
    plt.bar(x + i*width - width*1.5, values, width, label=metric)

plt.xlabel('–ú–æ–¥–µ–ª–∏')
plt.ylabel('–û—Ü–µ–Ω–∫–∞')
plt.title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è')
plt.xticks(x, models_names, rotation=45)
plt.legend(loc='lower right')
plt.ylim(0, 1)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('model_comparison.png', dpi=300)
print("‚úÖ –ì—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ 'model_comparison.png'")
plt.show()

# 7.3. –ú–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫ (Confusion Matrix) –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
print("\nüìä –ú–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏:")
fig, axes = plt.subplots(2, 2, figsize=(12, 10))
axes = axes.flatten()

for i, (model_name, result) in enumerate(results.items()):
    # –í—ã—á–∏—Å–ª—è–µ–º –º–∞—Ç—Ä–∏—Ü—É –æ—à–∏–±–æ–∫
    cm = confusion_matrix(y_test, result['y_pred'])
    
    # –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É –æ—à–∏–±–æ–∫
    sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', ax=axes[i])
    axes[i].set_title(f'{model_name}\n–¢–æ—á–Ω–æ—Å—Ç—å: {result["accuracy"]:.3f}')
    axes[i].set_xlabel('–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å')
    axes[i].set_ylabel('–ò—Å—Ç–∏–Ω–Ω—ã–π –∫–ª–∞—Å—Å')
    axes[i].set_xticklabels(['–ó–¥–æ—Ä–æ–≤', '–î–∏–∞–±–µ—Ç'])
    axes[i].set_yticklabels(['–ó–¥–æ—Ä–æ–≤', '–î–∏–∞–±–µ—Ç'])

plt.tight_layout()
plt.savefig('confusion_matrices.png', dpi=300)
print("‚úÖ –ú–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ 'confusion_matrices.png'")
plt.show()

# 7.4. –ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
print("\n" + "="*60)
print("–û–¢–ß–ï–¢ –ü–û –õ–£–ß–®–ï–ô –ú–û–î–ï–õ–ò:")
print("="*60)

# –ù–∞—Ö–æ–¥–∏–º –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –ø–æ F1-–º–µ—Ä–µ
best_model_name = results_df.iloc[0]['–ú–æ–¥–µ–ª—å']
best_model = results[best_model_name]['model']

print(f"\nüèÜ –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: {best_model_name}")
print(f"–ú–µ—Ç—Ä–∏–∫–∏ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏:")
for metric in ['–¢–æ—á–Ω–æ—Å—Ç—å (Accuracy)', '–¢–æ—á–Ω–æ—Å—Ç—å (Precision)', '–ü–æ–ª–Ω–æ—Ç–∞ (Recall)', 'F1-–º–µ—Ä–∞']:
    value = results_df[results_df['–ú–æ–¥–µ–ª—å'] == best_model_name][metric].values[0]
    print(f"  {metric}: {value:.3f}")

print("\nüìã –ü–æ–¥—Ä–æ–±–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–π –æ—Ç—á–µ—Ç:")
print(classification_report(y_test, results[best_model_name]['y_pred'], 
                           target_names=['–ó–¥–æ—Ä–æ–≤ (0)', '–î–∏–∞–±–µ—Ç (1)']))

# 7.5. –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–µ—Å–ª–∏ –º–æ–¥–µ–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)
if hasattr(best_model, 'feature_importances_'):
    print("\nüîç –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏:")
    feature_importance = pd.DataFrame({
        '–ü—Ä–∏–∑–Ω–∞–∫': X.columns,
        '–í–∞–∂–Ω–æ—Å—Ç—å': best_model.feature_importances_
    }).sort_values('–í–∞–∂–Ω–æ—Å—Ç—å', ascending=False)
    
    print(feature_importance)
    
    # –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    plt.figure(figsize=(10, 6))
    plt.barh(feature_importance['–ü—Ä–∏–∑–Ω–∞–∫'], feature_importance['–í–∞–∂–Ω–æ—Å—Ç—å'])
    plt.xlabel('–í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∞')
    plt.title('–í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏')
    plt.gca().invert_yaxis()  # –°–∞–º—ã–π –≤–∞–∂–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ —Å–≤–µ—Ä—Ö—É
    plt.tight_layout()
    plt.savefig('feature_importance.png', dpi=300)
    print("‚úÖ –ì—Ä–∞—Ñ–∏–∫ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ 'feature_importance.png'")
    plt.show()
elif hasattr(best_model, 'coef_'):
    # –î–ª—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
    print("\nüîç –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:")
    coefficients = pd.DataFrame({
        '–ü—Ä–∏–∑–Ω–∞–∫': X.columns,
        '–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç': best_model.coef_[0]
    }).sort_values('–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç', ascending=False)
    
    print(coefficients)

# ============================================================================
# –ë–õ–û–ö 8: –°–û–•–†–ê–ù–ï–ù–ò–ï –õ–£–ß–®–ï–ô –ú–û–î–ï–õ–ò
# ============================================================================

print("\n" + "="*60)
print("–®–ê–ì 6: –°–û–•–†–ê–ù–ï–ù–ò–ï –õ–£–ß–®–ï–ô –ú–û–î–ï–õ–ò")
print("="*60)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª—É—á—à—É—é –º–æ–¥–µ–ª—å
model_filename = 'best_diabetes_model.pkl'
joblib.dump(best_model, model_filename)
print(f"‚úÖ –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —Ñ–∞–π–ª: {model_filename}")

# –°–æ—Ö—Ä–∞–Ω—è–µ–º scaler –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ—Ç–æ—Ç–∏–ø–µ
scaler_filename = 'scaler.pkl'
joblib.dump(scaler, scaler_filename)
print(f"‚úÖ Scaler —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª: {scaler_filename}")

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
feature_names_filename = 'feature_names.pkl'
joblib.dump(list(X.columns), feature_names_filename)
print(f"‚úÖ –ù–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {feature_names_filename}")

# ============================================================================
# –ë–õ–û–ö 9: –ú–û–î–ï–õ–¨ –°–ò–°–¢–ï–ú–´ –ü–†–û–ì–ù–û–ó–ò–†–û–í–ê–ù–ò–Ø (–ö–û–ù–°–û–õ–¨–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï)
# ============================================================================

print("\n" + "="*60)
print("–®–ê–ì 7: –ú–û–î–ï–õ–¨ –°–ò–°–¢–ï–ú–´ –ü–†–û–ì–ù–û–ó–ò–†–û–í–ê–ù–ò–Ø")
print("="*60)

def predict_diabetes_risk():
    """
    –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∏—Å–∫–∞ –¥–∏–∞–±–µ—Ç–∞
    """
    print("\n" + "="*60)
    print("üîÆ –ú–û–î–ï–õ–¨ –°–ò–°–¢–ï–ú–´ –ü–†–û–ì–ù–û–ó–ò–†–û–í–ê–ù–ò–Ø –î–ò–ê–ë–ï–¢–ê")
    print("="*60)
    print("\n‚ö†Ô∏è –í–ê–ñ–ù–û: –≠—Ç–æ —É—á–µ–±–Ω–∞—è –º–æ–¥–µ–ª—å, –∞ –Ω–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç!")
    print("–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≥–Ω–æ–∑–∞ –ù–ï —è–≤–ª—è–µ—Ç—Å—è –¥–∏–∞–≥–Ω–æ–∑–æ–º.")
    print("–î–ª—è —Ç–æ—á–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –≤—Ä–∞—á—É.\n")
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –∏ scaler
    try:
        model = joblib.load('best_diabetes_model.pkl')
        scaler = joblib.load('scaler.pkl')
        feature_names = joblib.load('feature_names.pkl')
    except:
        print("‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏. –ò—Å–ø–æ–ª—å–∑—É—é —Ç–µ–∫—É—â—É—é –ª—É—á—à—É—é –º–æ–¥–µ–ª—å.")
        model = best_model
        scaler = scaler
        feature_names = list(X.columns)
    
    print("üìù –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞:")
    print("(–î–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–∫—É –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, –Ω–∞–ø—Ä–∏–º–µ—Ä: 25.5)")
    print()
    
    # –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    patient_data = {}
    
    # –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
    normal_ranges = {
        'Pregnancies': (0, 10),
        'Glucose': (70, 140),
        'BloodPressure': (60, 120),
        'SkinThickness': (10, 50),
        'Insulin': (0, 200),
        'BMI': (18.5, 30),
        'DiabetesPedigreeFunction': (0.1, 2.5),
        'Age': (20, 80)
    }
    
    for feature in feature_names:
        while True:
            try:
                # –ü–æ–ª—É—á–∞–µ–º –≤–≤–æ–¥ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                value = float(input(f"{feature} (–Ω–æ—Ä–º–∞: {normal_ranges[feature][0]}-{normal_ranges[feature][1]}): "))
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏)
                if feature not in ['DiabetesPedigreeFunction'] and value < 0:
                    print(f"‚ö†Ô∏è {feature} –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")
                    continue
                    
                patient_data[feature] = value
                break
                
            except ValueError:
                print("‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.")
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –º–æ–¥–µ–ª–∏
    patient_df = pd.DataFrame([patient_data])
    
    # –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
    patient_scaled = scaler.transform(patient_df)
    
    # –î–µ–ª–∞–µ–º –ø—Ä–æ–≥–Ω–æ–∑
    prediction = model.predict(patient_scaled)[0]
    prediction_proba = model.predict_proba(patient_scaled)[0]
    
    # –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    print("\n" + "="*60)
    print("üìä –†–ï–ó–£–õ–¨–¢–ê–¢ –ü–†–û–ì–ù–û–ó–ê:")
    print("="*60)
    
    risk_percentage = prediction_proba[1] * 100
    
    if prediction == 1:
        print(f"\n‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –¥–∏–∞–±–µ—Ç–∞")
        print(f"   –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–∏–∞–±–µ—Ç–∞: {risk_percentage:.1f}%")
        print(f"\nüí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:")
        print("   1. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –≤—Ä–∞—á—É –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è")
        print("   2. –°–¥–∞–π—Ç–µ –∞–Ω–∞–ª–∏–∑ –∫—Ä–æ–≤–∏ –Ω–∞ –≥–ª–∏–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥–µ–º–æ–≥–ª–æ–±–∏–Ω (HbA1c)")
        print("   3. –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–∏–µ—Ç—É –∏ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å")
    else:
        print(f"\n‚úÖ –†–∏—Å–∫ –¥–∏–∞–±–µ—Ç–∞ –Ω–∏–∑–∫–∏–π")
        print(f"   –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–∏–∞–±–µ—Ç–∞: {risk_percentage:.1f}%")
        print(f"\nüí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:")
        print("   1. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤–µ—Å—Ç–∏ –∑–¥–æ—Ä–æ–≤—ã–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏")
        print("   2. –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–º–æ—Ç—Ä—ã")
        print("   3. –°–ª–µ–¥–∏—Ç–µ –∑–∞ —É—Ä–æ–≤–Ω–µ–º –≥–ª—é–∫–æ–∑—ã –≤ –∫—Ä–æ–≤–∏")
    
    print("\nüìà –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:")
    print(f"   –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±—ã—Ç—å –∑–¥–æ—Ä–æ–≤—ã–º: {prediction_proba[0]*100:.1f}%")
    print(f"   –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–∏–∞–±–µ—Ç–∞: {prediction_proba[1]*100:.1f}%")
    
    # –ê–Ω–∞–ª–∏–∑ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    print("\nüîç –ê–Ω–∞–ª–∏–∑ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:")
    critical_params = []
    
    if patient_data['Glucose'] > 126:  # –ü–æ—Ä–æ–≥ –¥–ª—è –¥–∏–∞–±–µ—Ç–∞ –Ω–∞—Ç–æ—â–∞–∫
        critical_params.append(f"–ì–ª—é–∫–æ–∑–∞ ({patient_data['Glucose']} > 126)")
    
    if patient_data['BMI'] > 30:
        critical_params.append(f"–ò–ú–¢ ({patient_data['BMI']:.1f} > 30)")
    
    if patient_data['Age'] > 45:
        critical_params.append(f"–í–æ–∑—Ä–∞—Å—Ç ({patient_data['Age']} > 45)")
    
    if critical_params:
        print("   –ü–æ–≤—ã—à–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∏—Å–∫–∞:")
        for param in critical_params:
            print(f"   - {param}")
    
    print("\n" + "="*60)
    print("–ü–æ–º–Ω–∏—Ç–µ: —ç—Ç–æ –ª–∏—à—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞.")
    print("–¢–æ—á–Ω—ã–π –¥–∏–∞–≥–Ω–æ–∑ –º–æ–∂–µ—Ç –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ä–∞—á!")
    print("="*60)

# ============================================================================
# –ë–õ–û–ö 10: –ó–ê–ü–£–°–ö –ú–û–î–ï–õ–ò
# ============================================================================

# –°–ø—Ä–æ—Å–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ö–æ—á–µ—Ç –ª–∏ –æ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
response = input("\nüöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–¥–µ–ª—å —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è? (–¥–∞/–Ω–µ—Ç): ")

if response.lower() in ['–¥–∞', '–¥', 'yes', 'y']:
    # –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ç–æ—Ç–∏–ø
    predict_diabetes_risk()
    
    # –°–ø—Ä–æ—Å–∏–º, —Ö–æ—á–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–¥–µ–ª–∞—Ç—å –µ—â–µ –æ–¥–∏–Ω –ø—Ä–æ–≥–Ω–æ–∑
    while True:
        again = input("\nüîÅ –°–¥–µ–ª–∞—Ç—å –µ—â–µ –æ–¥–∏–Ω –ø—Ä–æ–≥–Ω–æ–∑? (–¥–∞/–Ω–µ—Ç): ")
        if again.lower() in ['–¥–∞', '–¥', 'yes', 'y']:
            predict_diabetes_risk()
        else:
            print("\nüëã –°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è!")
            break
else:
    print("\nüëã –ú–æ–¥–µ–ª—å —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–µ –ø–æ–∑–∂–µ, –≤—ã–∑–≤–∞–≤ —Ñ—É–Ω–∫—Ü–∏—é predict_diabetes_risk()")

# ============================================================================
# –ë–õ–û–ö 11: –í–´–í–û–î–´ –ò –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï
# ============================================================================

print("\n" + "="*60)
print("–í–´–í–û–î–´ –ò –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï")
print("="*60)

print("\nüìä –û–°–ù–û–í–ù–´–ï –í–´–í–û–î–´ –ü–†–û–ï–ö–¢–ê:")
print("1. –ù–∞–∏–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∞ –º–æ–¥–µ–ª—å: " + best_model_name)
print(f"2. F1-–º–µ—Ä–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {results[best_model_name]['f1']:.3f}")
print(f"3. –¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è: {results[best_model_name]['accuracy']:.3f}")

print("\nüîç –ö–õ–Æ–ß–ï–í–´–ï –§–ê–ö–¢–û–†–´ –†–ò–°–ö–ê –î–ò–ê–ë–ï–¢–ê:")
if hasattr(best_model, 'feature_importances_'):
    importance_df = pd.DataFrame({
        '–ü—Ä–∏–∑–Ω–∞–∫': X.columns,
        '–í–∞–∂–Ω–æ—Å—Ç—å': best_model.feature_importances_
    }).sort_values('–í–∞–∂–Ω–æ—Å—Ç—å', ascending=False)
    
    top_features = importance_df.head(3)['–ü—Ä–∏–∑–Ω–∞–∫'].tolist()
    print(f"   –°–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: {', '.join(top_features)}")

print("\n‚ö†Ô∏è –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –ò –≠–¢–ò–ß–ï–°–ö–ò–ï –ê–°–ü–ï–ö–¢–´:")
print("1. –≠—Ç–æ —É—á–µ–±–Ω—ã–π –ø—Ä–æ—Ç–æ—Ç–∏–ø, –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏")
print("2. –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö")
print("3. –í–∞–∂–Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —Å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏")
print("4. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö")

print("\nüéØ –î–ê–õ–¨–ù–ï–ô–®–ï–ï –†–ê–ó–í–ò–¢–ò–ï –ü–†–û–ï–ö–¢–ê:")
print("1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ (–Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏)")
print("2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏)")
print("3. –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è")
print("4. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –¥—Ä—É–≥–∏—Ö –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö")

print("\n‚úÖ –ü–†–û–ï–ö–¢ –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù!")
print("="*60)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
with open('project_summary.txt', 'w', encoding='utf-8') as f:
    f.write("–ü–†–û–ï–ö–¢: –ú–æ–¥–µ–ª—å —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è —Å–∞—Ö–∞—Ä–Ω—ã–º –¥–∏–∞–±–µ—Ç–æ–º —Å –ø–æ–º–æ—â—å—é ML\n")
    f.write("="*60 + "\n")
    f.write(f"–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: {best_model_name}\n")
    f.write(f"F1-–º–µ—Ä–∞: {results[best_model_name]['f1']:.3f}\n")
    f.write(f"–¢–æ—á–Ω–æ—Å—Ç—å: {results[best_model_name]['accuracy']:.3f}\n\n")
    f.write(results_df.to_string())
    
